{% extends "sms/index.html" %}
{% block chatBlock %}

<div class="chat-header d-flex align-items-center">
    <div class="chat-toggle-btn"><i class='bx bx-menu-alt-left'></i>
    </div>
    <div>
        <h4 class="mb-1 font-weight-bold">{% if client.name %}{{client.name}} - {{client.phone_number}}{% else %}Unknown - {{client.phone_number}}{%endif%}</h4>
        <div class="list-inline d-sm-flex mb-0 d-none"> <a href="javascript:;" class="list-inline-item d-flex align-items-center text-secondary"><small class='bx bxs-circle me-1 chart-online'></small>Active Now</a>
            <a href="javascript:;" class="list-inline-item d-flex align-items-center text-secondary">|</a>
            <a href="javascript:;" class="list-inline-item d-flex align-items-center text-secondary"><i class='bx bx-search me-1'></i>Find</a>
        </div>
    </div>
</div>
<div class="chat-content" id="chat-content">
    {% for message in messages %}
        {%if message.sender_type == 'Client'%}
            <div class="chat-content-leftside">
                <div class="d-flex">
                    <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    <div class="flex-grow-1 ms-2">
                        <p class="mb-0 chat-time">{% if client.name %}{{client.name}}{% else %}{{client.phone_number}}{%endif%}, {{message.created_at|date:"g:i A"}}</p>
                        {% if message.file %}
                        <p class="chat-left-msg">
                            <img class="img-responsive" src="{{ message.file.file.url }}" alt="">
                        </p>
                        {% else %}
                        <p class="chat-left-msg">{{message.message_content}}</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        {%elif message.sender_type == 'Agent'%}
            <div class="chat-content-rightside">
                <div class="d-flex ms-auto">
                    <div class="flex-grow-1 me-2">
                        <p class="mb-0 chat-time text-end">{{message.sender.username}}, {{message.created_at|date:"g:i A"}}</p>
                        {% if message.file %}
                        <p class="chat-left-msg">
                            <img class="img-responsive" src="{{ message.file.file.url }}" alt="">
                        </p>
                        {% else %}
                        <p class="chat-right-msg">{{message.message_content}}</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endif %}
    {% endfor %}
</div>
<div class="chat-footer d-flex align-items-center">
    <div class="flex-grow-1 pe-2">
        <div class="input-group">
            <input id="messageContent" type="text" class="form-control" placeholder="Type a message">
        </div>
    </div>
    <div class="chat-footer-menu" id="sendMessage">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-send text-primary">
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
        </svg>
    </div>
</div>
<style>
    .img-responsive {
        width: 100%;
        height: auto;
        max-width: 600px;
        max-width: 600px;
        object-fit: contain;
        border-radius: 10px;
    }
</style>
{% endblock %}